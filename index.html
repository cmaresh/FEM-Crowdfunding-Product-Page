<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- displays site properly based on user's device -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Commissioner:wght@400;500;700&display=swap" rel="stylesheet"> 
  <link rel="icon" type="image/png" sizes="32x32" href="./images/favicon-32x32.png">
  <link rel="stylesheet" type="text/css" href="style.css" />
  <title>Frontend Mentor | Crowdfunding product page</title>
</head>
<body>
  <header id="header-main">
    <img id="logo" src="./images/logo.svg" alt="Logo" />
    <img id="menu-icon" src="./images/icon-hamburger.svg" alt="Menu" />
    <nav>
      <a href="">About</a>
      <a href="">Discover</a>
      <a href="">Get Started</a>
    </nav>
  </header>

  <div id="hero-image"></div>

  <section id="intro">
    <header>
      <h1>Mastercraft Bamboo Monitor Riser</h1>
      A beautiful & handcrafted monitor stand to reduce neck and eye strain.
    </header>
    
    <div id="options">
      <button id="back-project-button">Back this project</button>
      <button id="bookmark" class="collapsable active">
        <svg width="56" height="56" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><circle fill="#2F2F2F" cx="28" cy="28" r="28"/><path fill="#B1B1B1" d="M23 19v18l5-5.058L33 37V19z"/></g></svg>
        <div class="collapse">Bookmark</div>
      </button>
    </div>
  </section>

  <section id="statistics">
    <ul>
      <li>
        <strong data-bind="fundsRaised"></strong>
        <small>of $100,000 backed</small>
      </li>
      <hr>
      <li>
        <strong data-bind="totalBackers"></strong>
        <small>total backers</small>
      </li>
      <hr>
      <li>
        <strong data-bind="daysLeft"></strong>
        <small>days left</small>
      </li>
    </ul>
    <div id="goal-progress"></div>
  </section>

  <section id="rewards">
    <header>
      <h2>About this project</h2>
    </header>
    <p>The Mastercraft Bamboo Monitor Riser is a sturdy and stylish platform that elevates your screen 
    to a more comfortable viewing height. Placing your monitor at eye level has the potential to improve 
    your posture and make you more comfortable while at work, helping you stay focused on the task at hand.</p>
    <p>Featuring artisan craftsmanship, the simplicity of design creates extra desk space below your computer 
    to allow notepads, pens, and USB sticks to be stored under the stand.</p>
    <ul id="reward-list">
      <li data-reward="0">
        <header>
          <h3>Bamboo Stand</h3>
          <h4>Pledge $25 or more</h4>
        </header>
        <p>You get an ergonomic stand made of natural bamboo. You've helped us launch our promotional campaign, and 
        you’ll be added to a special Backer member list.</p>
        <footer>
          <div class="remaining-rewards">
            <strong data-bind="itemsRemaining"></strong> left
          </div>
          <button data-reward="0">Select Reward</button>
        </footer>
      </li>
      <li data-reward="1">
        <header>
          <h3>Black Edition Stand</h3>
          <h4>Pledge $75 or more</h4>
        </header>
        <p>You get a Black Special Edition computer stand and a personal thank you. You’ll be added to our Backer 
        member list. Shipping is included.</p>
        <footer>
          <div class="remaining-rewards">
            <strong data-bind="itemsRemaining"></strong> left
          </div>
          <button data-reward="1">Select Reward</button>
        </footer>
      </li>
      <li data-reward="2" class="unavailable">
        <header>
          <h3>Mahogany Special Edition</h3>
          <h4>Pledge $200 or more</h4>
        </header>
        <p>You get two Special Edition Mahogany stands, a Backer T-Shirt, and a personal thank you. You’ll be added 
        to our Backer member list. Shipping is included.</p>
        <footer>
          <div class="remaining-rewards">
            <strong data-bind="itemsRemaining"></strong> left
          </div>
          <button class="disabled">Out of Stock</button>
        </footer>
      </li>
    </ul>
  </section>
  <!-- Selection modal start -->
  <div class="modal" id="back-project">
    <div class="modal-blur"></div>
    <div class="modal-content">
      <img class="close-modal" src="images/icon-close-modal.svg" alt="Close" />

      <h2>Back this project</h2>
      Want to support us in bringing Mastercraft Bamboo Monitor Riser out in the world?

      <ul id="pledge-list">
        <li>
          <div class="top">
            <h3><div class="reward-select"></div>Pledge with no reward</h3>
            <span>Choose to support us without a reward if you simply believe in our project. As a backer, 
              you will be signed up to receive product updates via email.</span>
          </div>
          <div class="bottom">
            <h5>Enter your pledge</h5>
            <div>
              <div class="pledge-amount">
                <input class="pledge-input" type="text"></input>
              </div>
              <button class="continue">Continue</button>
            </div>
          </div>
        </li>
        <li data-reward="0">
          <div class="top">
            <h3><div class="reward-select"></div>Bamboo Stand</h3>
            <h4>Pledge $25 or more</h4>
            <span>You get an ergonomic stand made of natural bamboo. You've helped us launch our promotional campaign, and
              you’ll be added to a special Backer member list.</span>
            <div class="remaining-rewards">
              <strong data-bind="itemsRemaining"></strong> left
            </div>
          </div>
          <!-- Selected pledge start -->
          <div class="bottom">
            <h5>Enter your pledge</h5>
            <div>
              <div class="pledge-amount">
                <input class="pledge-input" data-reward="0" type="text"></input>
              </div>
              <button class="continue">Continue</button>
            </div>
          </div>
          <!-- Selected pledge end -->
        </li>
        <li data-reward="1">
          <div class="top">
            <h3><div class="reward-select"></div>Black Edition Stand</h3>
            <h4>Pledge $75 or more</h4>
            <span>You get a Black Special Edition computer stand and a personal thank you. You’ll be added to our Backer
              member list. Shipping is included.</span>
            <div class="remaining-rewards">
              <strong data-bind="itemsRemaining"></strong> left
            </div>
          </div>
          <!-- Selected pledge start -->
          <div class="bottom">
            <h5>Enter your pledge</h5>
            <div>
              <div class="pledge-amount">
                <input class="pledge-input" data-reward="1" type="text"></input>
              </div>
              <button class="continue">Continue</button>
            </div>
          </div>
          <!-- Selected pledge end -->
        </li>
        <li data-reward="2" class="disabled">
          <div class="top">
            <h3><div class="reward-select"></div>Mahogany Special Edition</h3>
            <h4>Pledge $200 or more</h4>
            <span>You get two Special Edition Mahogany stands, a Backer T-Shirt, and a personal thank you. You’ll be added
              to our Backer member list. Shipping is included.</span>
            <div class="remaining-rewards">
              <strong data-bind="itemsRemaining"></strong> left
            </div>
          </div>
          <!-- Selected pledge  start -->
          <div class="bottom">
            <h5>Enter your pledge</h5>
            <div>
              <div class="pledge-amount">
                <input class="pledge-input" data-reward="2" type="text"></input>
              </div>
              <button class="continue">Continue</button>
            </div>
          </div>
          <!-- Selected pledge end -->
        </li>
      </ul>
    </div>
  </div>
  <!-- Selection modal end -->
  <!-- Success modal start -->
  <div class="modal" id="thanks-modal">
    <div class="modal-blur"></div>
    <div class="modal-content">
      <img src="./images/icon-check.svg" alt="check"> 
      <h2>Thanks for your support!</h2>
      <p>Your pledge brings us one step closer to sharing Mastercraft Bamboo Monitor Riser worldwide. You will get
      an email once our campaign is completed.</p>
      <button id="got-it">Got it!</button>
    </div>
  </div>
  <!-- Success modal end -->

  <script>
    const db = {
      fundsRaised: 89914,
      fundsGoal: 100000,
      totalBackers: 5007,
      daysLeft: 56,
      itemsRemaining: [
        101,
        64,
        0
      ]
    }

    const formatter = new Intl.NumberFormat('en-US', {
      style: 'currency',
      currency: 'USD',
      maximumFractionDigits: 0,
    });

    document.addEventListener('DOMContentLoaded', () => {
      const hero = document.getElementById('hero-image');
      const pledgeItems = document.querySelectorAll('#pledge-list li');
      if (window.innerWidth <= 375) {
        hero.style.backgroundImage = 'url(./images/image-hero-mobile.jpg)';
      } else {
        hero.style.backgroundImage = 'url(./images/image-hero-desktop.jpg)';
      }

      fundsRaisedElems = document.querySelectorAll('[data-bind="fundsRaised"]');
      totalBackersElems = document.querySelectorAll('[data-bind="totalBackers"]');
      daysLeftElems = document.querySelectorAll('[data-bind="daysLeft"]');
      itemsRemainingElems = [];
      for (let i = 0; i < 3; i++) {
        itemsRemainingElems.push(
          document.querySelectorAll('li[data-reward="' + i + '"] [data-bind="itemsRemaining"]')
        )
      }

      function updateView() {
        fundsRaisedElems.forEach(e => e.textContent = formatter.format(db.fundsRaised));

        document.documentElement.style.setProperty("--completion-width", (db.fundsRaised / db.fundsGoal) * 100 + "%")

        totalBackersElems.forEach(e => e.textContent = db.totalBackers);
        daysLeftElems.forEach(e => e.textContent = db.daysLeft);
        for (let i = 0; i < itemsRemainingElems.length; i++) {
          itemsRemainingElems[i].forEach(e => {
            e.textContent = db.itemsRemaining[i];
          })
        }
      }
      updateView();

      const bookmarkElem = document.getElementById('bookmark');
      bookmarkElem.addEventListener('click', e => {
        bookmarkElem.classList.toggle('active');
      });

      function selectReward(curr) {
        pledgeItems.forEach(e => e.classList.remove('active'));
        while (curr.nodeName != "LI" && curr.parentNode) curr = curr.parentNode;
        curr.classList.toggle('active');
      }

      document.querySelectorAll('#reward-list li footer button').forEach(button => {
        button.addEventListener('click', (e) => {
          const reward = e.target.dataset.reward;
          const modal = document.getElementById('back-project');
          modal.style.display = 'flex';
          selectReward(document.querySelector('#back-project li[data-reward="' + reward + '"]'));
        });
      });

      const allModals = document.querySelectorAll('.modal');

      function closeModals() {
        allModals.forEach(modal => {
          modal.style.display = 'none';
          modal.querySelectorAll('input').forEach(e => e.value = '');
        });
      }

      document.querySelectorAll('.modal-blur, .close-modal, #got-it').forEach(modal => {
        modal.addEventListener('click', e => closeModals() );
      });

      document.querySelectorAll('.top h3').forEach(rs => {
        rs.addEventListener('click', e => {
          selectReward(e.target);
        })
      });

      document.getElementById('back-project-button').addEventListener('click', e => {
        const modal = document.getElementById('back-project');
        modal.style.display = 'flex';
      });

      document.querySelectorAll('button.continue')
      .forEach(e => {
        e.addEventListener('click', e => {
          let curr = e.target;
          while (curr.nodeName != "LI" && curr.parentNode) curr = curr.parentNode;
          const reward = curr.dataset.reward;
          const donation = curr.querySelector('input').value;
          if (reward) db.itemsRemaining[reward]--;
          if (donation) db.fundsRaised += parseInt(donation);
          db.totalBackers++;
          updateView();
          closeModals();
          document.getElementById('thanks-modal').style.display = 'flex';
        })
      })
    });
  </script>
</body>
</html>